<!-- templates/index.html -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Open Crucible</title>
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="/static/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-bar-left">
      <!-- Hamburger Button to Toggle Sidebar -->
      <button class="hamburger-btn" onclick="toggleSidebar()">‚ò∞</button>
      <button class="btn-home" onclick="window.location.href='/';">
        Open Crucible
      </button>
    </div>
  </div>

  <!-- Sidebar for Options with a Generic Dropdown -->
  <div class="sidebar" id="sidebar">
    <div class="dropdown">
      <h2 class="dropdown-header" onclick="toggleDropdown()">
        Options <span id="dropdownArrow"><i class="fa-solid fa-chevron-down"></i></span>
      </h2>
      <div class="dropdown-content" id="dropdownContent">
        <section>
          <label for="modelChoice">Model Choice:</label>
          <select id="modelChoice" class="styled-input">
            <option value="de0b4c67-de5e-4bbf-82ec-6fffce8e1b83">Llama-3.1-8B (Default)</option>
            <option value="3cb9bc3f-05a8-4644-8b83-9d7010edf301">Llama-3.1-8B 4bit Quantized</option>
          </select>
        </section>
        <section>
          <label for="maxTokens">Max new tokens:</label>
          <input id="maxTokens" type="number" value="100" class="styled-input" />
        </section>
      </div>
    </div>
    
    <!-- Add the logout button at the bottom of the sidebar -->
    <div class="sidebar-footer">
      <button onclick="logout()" class="logout-btn">
        Logout
      </button>
    </div>
  </div>

  <!-- Main container for content (only shown after login in a real app) -->
  <div class="container" id="mainContent">
    <h1>We ‚ù§Ô∏è Open Crucible üòä</h1>
    
    <!-- Levels Section -->
    <section id="levelSelection">
      <h2 id="levelSelectionHeader">
        Levels<span id="levelToggleIcon">‚ñº</span>
      </h2>
      <div id="levelSelectionContainer"></div>
    </section>

    <!-- Progress Bar Section -->
    <section id="progressSection">
      <h2>Progress</h2>
      <div class="progress-bar-container" data-text="0/3">
        <div class="progress-bar"></div>
      </div>
    </section>

    <!--- Description of the Level -->
    <section>
      <h2>Level Description:</h2>
      <div id="description-box" class="display-box">
        <!-- Populated by JavaScript -->
      </div>
    </section>

    <section>
      <h2>System Prompt:</h2>
      <div class="prompt-box">
        <!-- Populated by JavaScript -->
      </div>
    </section>

    <!-- Chat Window Section -->
    <div class="chat-window">
        <h2>Conversation History</h2>
        <div class="chat-history" id="chatHistory">
        <!-- Chat messages will be appended here -->
        </div>
        <!-- Resizer handle for the chat window -->
        <div id="chatResizer"></div>
        <!-- Optional: Chat input area for new messages -->
        <div class="chat-input">
          <input type="text" id="chatInput" class="styled-input" placeholder="Type your message here..." />
          <button id="chatSendBtn" class="btn-submit">Send</button>
        </div>
    </div>

    <hr />

    <section>
      <h2>Prompt Passed to Model:</h2>
      <div id="displayCombinedPrompt" class="display-box"></div>
    </section>

    <section>
      <h2>Input Tokens:</h2>
      <div id="userTokenDisplay" class="token-display"></div>
    </section>

    <section>
      <h2>Model Output:</h2>
      <div id="displayOutputText" class="display-box"></div>
    </section>

    <section>
      <h2>Output Tokens:</h2>
      <div id="outputTokenDisplay" class="token-display"></div>
    </section>
  </div>

  <script src="/static/main.js"></script>
  <script>
    // Sidebar and Dropdown Toggling
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
    }
  
    function toggleDropdown() {
      const dropdownContent = document.getElementById('dropdownContent');
      const arrow = document.getElementById('dropdownArrow');
      dropdownContent.classList.toggle('active');
      arrow.textContent = dropdownContent.classList.contains('active') ? '‚ñ≤' : '‚ñº';
    }
  
    // Toggle between native login and registration forms
    function toggleAuth() {
      const loginForm = document.getElementById('loginForm');
      const registerForm = document.getElementById('registerForm');
      const authTitle = document.getElementById('authTitle');
      if (loginForm.classList.contains('hidden')) {
        loginForm.classList.remove('hidden');
        registerForm.classList.add('hidden');
        authTitle.textContent = 'Login';
      } else {
        loginForm.classList.add('hidden');
        registerForm.classList.remove('hidden');
        authTitle.textContent = 'Register';
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</body>
</html>
