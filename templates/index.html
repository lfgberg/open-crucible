<!-- templates/index.html -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Open Crucible</title>
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-left">
        <!-- Hamburger Button to Toggle Sidebar -->
        <button class="hamburger-btn" onclick="toggleSidebar()">‚ò∞</button>
        <button class="btn-home" onclick="window.location.href='/';">
            Open Crucible
        </button>
        </div>
        <div class="top-bar-right">
        <button class="btn-top" onclick="window.location.href='https://magic-box.dev';">
            Magic Box Blog
        </button>
        <!-- Additional top bar buttons if needed -->
        </div>
    </div>
    
    <!-- Sidebar for Options with a Generic Dropdown -->
    <div class="sidebar" id="sidebar">
        <div class="dropdown">
        <h2 class="dropdown-header" onclick="toggleDropdown()">
            Options <span id="dropdownArrow">‚ñº</span>
        </h2>
        <div class="dropdown-content" id="dropdownContent">
            <section>
            <label for="modelChoice">Model Choice:</label>
            <select id="modelChoice" class="styled-input">
                <option value="de0b4c67-de5e-4bbf-82ec-6fffce8e1b83">Llama-3.1-8B (Default)</option>
                <option value="3cb9bc3f-05a8-4644-8b83-9d7010edf301">Llama-3.1-8B 4bit Quantized</option>
            </select>
            </section>
            <section>
            <label for="maxTokens">Max new tokens:</label>
            <input id="maxTokens" type="number" value="100" class="styled-input" />
            </section>
            <section>
            <label for="systemPromptChoice">Select System Prompt:</label>
            <select id="systemPromptChoice" class="styled-input">
                {% for option in prompt_options %}
                <option value="{{ option }}">{{ option | capitalize }}</option>
                {% endfor %}
            </select>
            </section>
        </div>
        </div>
    </div>

  <!-- Main container for content -->
  <div class="container">
    <h1>We ‚ù§Ô∏è Open Crucible üòä</h1>

    <section>
      <h2>System Prompt:</h2>
      <div class="prompt-box">
        {{ system_prompt }}
      </div>
    </section>

    <section>
      <h2>User Prompt:</h2>
      <textarea id="userPrompt" rows="4" cols="70" class="styled-input" placeholder="Type your prompt here..."></textarea>
      <br/><br/>
      <button id="submitBtn" class="btn-submit">Submit</button>
    </section>

    <div id="modelSpinner" class="spinner hidden">
      <div class="loader"></div>
    </div>
    <div id="modelStatusMessage"></div>

    <div id="spinner" class="spinner hidden">
      <div class="loader"></div>
      <p>Generating text...</p>
    </div>

    <hr />

    <section>
      <h2>Prompt Passed to Model:</h2>
      <div id="displayCombinedPrompt" class="display-box"></div>
    </section>

    <section>
      <h2>User Tokens:</h2>
      <div id="userTokenDisplay" class="token-display"></div>
    </section>

    <section>
      <h2>Model Output:</h2>
      <div id="displayOutputText" class="display-box"></div>
    </section>

    <section>
      <h2>Output Tokens:</h2>
      <div id="outputTokenDisplay" class="token-display"></div>
    </section>
  </div>

  <script src="/static/main.js"></script>
  <script>
    function toggleSidebar() {
      var sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('active');
    }
  </script>
  <script>
    // Toggle the sidebar visibility (slides in from the left)
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
    }
  
    // Toggle the generic dropdown inside the sidebar
    function toggleDropdown() {
      const dropdownContent = document.getElementById('dropdownContent');
      const arrow = document.getElementById('dropdownArrow');
      dropdownContent.classList.toggle('active');
      // Change arrow direction
      if (dropdownContent.classList.contains('active')) {
        arrow.textContent = '‚ñ≤';
      } else {
        arrow.textContent = '‚ñº';
      }
    }
  </script>
</body>
</html>
